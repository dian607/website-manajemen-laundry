<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Manajemen Laundry</title>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="brand">
                <i class="ph-fill ph-waves"></i>
                <span>IbawWashing</span>
            </div>
            <nav class="nav-links">
                <a href="#input-transaksi" class="nav-item active">
                    <i class="ph ph-plus-circle"></i> Transaksi Baru
                </a>
                <a href="#riwayat-transaksi" class="nav-item">
                    <i class="ph ph-receipt"></i> Riwayat
                </a>
                <a href="#data-pelanggan" class="nav-item">
                    <i class="ph ph-users"></i> Pelanggan
                </a>
                <a href="#data-layanan" class="nav-item">
                    <i class="ph ph-package"></i> Layanan
                </a>
                <a href="#laporan" class="nav-item">
                    <i class="ph ph-chart-bar"></i> Laporan
                </a>
            </nav>
            
            <div style="margin-top: auto; width: 100%;">
                <button id="logoutBtn">
                    <i class="ph-bold ph-sign-out"></i> LOG OUT
                </button>
            </div>
        </aside>

        <main class="main-content">
            <div class="top-bar">
                <div>
                    <h3>Dashboard</h3>
                    <p style="color: var(--text-muted); font-size: 0.9rem;">Kelola semua aktivitas laundry di sini.</p>
                </div>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-weight: 600;">Admin</span>
                </div>
            </div>
            
            <section id="input-transaksi" class="card active-section">
                <h2><i class="ph ph-plus-circle"></i> Input Transaksi Baru</h2>
                <form id="transactionForm">
                    <div class="grid-3">
                        <div style="grid-column: span 2;">
                            <div class="grid-2">
                                <div class="input-group">
                                    <label>Pilih Pelanggan</label>
                                    <select id="selectCustomer" required></select>
                                </div>
                                <div class="input-group">
                                    <label>Jenis Layanan</label>
                                    <select id="selectService" required></select>
                                </div>
                                <div class="input-group">
                                    <label>Berat (Kg) / Jumlah</label>
                                    <input type="number" id="weight" required min="0.1" step="0.1" value="1">
                                </div>
                                <div class="input-group">
                                    <label>Metode Pembayaran</label>
                                    <select id="paymentMethod" required>
                                        <option value="Tunai">Tunai</option>
                                        <option value="Transfer Bank">Transfer Bank</option>
                                        <option value="E-Wallet">QRIS / E-Wallet</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div>
                            <div class="price-display">
                                <span>Total Tagihan</span>
                                <h3 id="totalCostDisplay">Rp 0</h3>
                                <input type="hidden" id="totalCost" value="0">
                            </div>
                            <div style="background: #f9fafb; padding: 1rem; border-radius: 8px; border: 1px solid #eee;">
                                <small style="color: var(--text-muted);">Estimasi Selesai:</small>
                                <p id="estimatedPickupDate" style="font-weight: 600;">-</p>
                            </div>
                            <button type="submit" class="primary-btn" style="width: 100%; margin-top: 1rem; padding: 1rem;">
                                <i class="ph-bold ph-printer"></i> Proses & Cetak
                            </button>
                        </div>
                    </div>
                    <p id="transaction-message" class="info-text"></p>
                </form>
            </section>

            <section id="riwayat-transaksi" class="card hidden-section">
                <h2><i class="ph ph-clock-counter-clockwise"></i> Riwayat Transaksi</h2>
                <div class="table-container">
                    <table id="transactionTable">
                        <thead>
                            <tr>
                                <th>ID TRX</th>
                                <th>Pelanggan</th>
                                <th>Layanan</th>
                                <th>Total</th>
                                <th>Estimasi</th>
                                <th>Status</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>
            
            <section id="data-pelanggan" class="card hidden-section">
                <h2><i class="ph ph-users-three"></i> Data Pelanggan</h2>
                <div class="grid-2" style="align-items: start;">
                    <form id="customerForm" style="background: #f9fafb; padding: 1.5rem; border-radius: 12px; border: 1px solid var(--border);">
                        <h4 style="margin-bottom: 1rem;">Tambah Pelanggan</h4>
                        <div class="input-group">
                            <label>Nama </label>
                            <input type="text" id="customerName" required>
                        </div>
                        <div class="input-group">
                            <label>No. Telepon / WA</label>
                            <input type="tel" id="customerPhone" required>
                        </div>
                        <div class="input-group">
                            <label>Alamat</label>
                            <textarea id="customerAddress" rows="2" required></textarea>
                        </div>
                        <button type="submit" class="primary-btn"><i class="ph ph-floppy-disk"></i> Simpan</button>
                        <p id="customer-message" class="info-text"></p>
                    </form>

                    <div class="table-container">
                        <table id="customerTable">
                            <thead>
                                <tr>
                                    <th>Nama</th>
                                    <th>Telepon</th>
                                    <th>Alamat</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="data-layanan" class="card hidden-section">
                <h2><i class="ph ph-t-shirt"></i> Jenis Layanan</h2>
                <div class="grid-2" style="align-items: start;">
                    <form id="serviceForm" style="background: #f9fafb; padding: 1.5rem; border-radius: 12px; border: 1px solid var(--border);">
                        <h4 style="margin-bottom: 1rem;">Tambah Layanan</h4>
                        <div class="input-group">
                            <label>Nama Layanan</label>
                            <input type="text" id="serviceName" required placeholder="Contoh: Cuci Komplit">
                        </div>
                        <div class="grid-2" style="gap: 10px;">
                            <div class="input-group">
                                <label>Harga (Rp)</label>
                                <input type="number" id="servicePrice" required>
                            </div>
                            <div class="input-group">
                                <label>Durasi (Jam)</label>
                                <input type="number" id="serviceDuration" required>
                            </div>
                        </div>
                        <button type="submit" class="primary-btn"><i class="ph ph-plus"></i> Tambah</button>
                        <p id="service-message" class="info-text"></p>
                    </form>

                    <div class="table-container">
                        <table id="serviceTable">
                            <thead>
                                <tr>
                                    <th>Layanan</th>
                                    <th>Harga</th>
                                    <th>Durasi</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section id="laporan" class="hidden-section">
                <div class="grid-3" style="margin-bottom: 2rem;">
                    <div class="stats-card bg-blue">
                        <div class="stats-icon"><i class="ph-fill ph-receipt"></i></div>
                        <div class="stats-info">
                            <h4>Total Transaksi</h4>
                            <p id="totalTransaksiDisplay">0</p>
                        </div>
                    </div>
                    <div class="stats-card bg-green">
                        <div class="stats-icon"><i class="ph-fill ph-currency-dollar"></i></div>
                        <div class="stats-info">
                            <h4>Pendapatan</h4>
                            <p id="totalPendapatanDisplay" style="font-size: 1.3rem;">Rp 0</p>
                        </div>
                    </div>
                    <div class="stats-card bg-orange">
                        <div class="stats-icon"><i class="ph-fill ph-basket"></i></div>
                        <div class="stats-info">
                            <h4>Belum Diambil</h4>
                            <p id="belumDiambilDisplay">0</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>Detail Keuangan (Selesai/Diambil)</h2>
                    <div class="table-container">
                        <table id="reportTable">
                            <thead>
                                <tr>
                                    <th>Tanggal</th> 
                                    <th>No. TRX</th>
                                    <th>Pelanggan</th>
                                    <th>Total</th>
                                    <th>Metode</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <div id="modalEditCustomer" class="modal-overlay hidden-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="ph-bold ph-pencil-simple"></i> Edit Data Pelanggan</h3>
                <button class="close-btn" onclick="closeModal('modalEditCustomer')">&times;</button>
            </div>
            <form id="formEditCustomer">
                <input type="hidden" id="editCustId">
                <div class="input-group">
                    <label>Nama Pelanggan</label>
                    <input type="text" id="editCustName" required>
                </div>
                <div class="input-group">
                    <label>No. Telepon</label>
                    <input type="text" id="editCustPhone" required>
                </div>
                <div class="input-group">
                    <label>Alamat</label>
                    <textarea id="editCustAddress" rows="3" required></textarea>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-cancel" onclick="closeModal('modalEditCustomer')">Batal</button>
                    <button type="submit" class="primary-btn">Simpan Perubahan</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modalEditService" class="modal-overlay hidden-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="ph-bold ph-t-shirt"></i> Edit Layanan</h3>
                <button class="close-btn" onclick="closeModal('modalEditService')">&times;</button>
            </div>
            <form id="formEditService">
                <input type="hidden" id="editServId">
                <div class="input-group">
                    <label>Nama Layanan</label>
                    <input type="text" id="editServName" required>
                </div>
                <div class="grid-2">
                    <div class="input-group">
                        <label>Harga (Rp)</label>
                        <input type="number" id="editServPrice" required>
                    </div>
                    <div class="input-group">
                        <label>Durasi (Jam)</label>
                        <input type="number" id="editServDuration" required>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-cancel" onclick="closeModal('modalEditService')">Batal</button>
                    <button type="submit" class="primary-btn">Simpan Perubahan</button>
                </div>
            </form>
        </div>
    </div>
    <div id="modalStatus" class="modal-overlay hidden-modal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3><i class="ph-bold ph-arrows-clockrise"></i> Update Status</h3>
                <button class="close-btn" onclick="closeModal('modalStatus')">&times;</button>
            </div>
            <form id="formStatus">
                <input type="hidden" id="statusTrxId">
                <div class="input-group">
                    <label>Pilih Status Terbaru:</label>
                    <select id="selectNewStatus" required style="padding: 10px; font-size: 1rem;">
                        <option value="Diterima">Diterima (Baru Masuk)</option>
                        <option value="Diproses">Diproses (Sedang Dicuci)</option>
                        <option value="Selesai">Selesai (Siap Diambil)</option>
                        <option value="Diambil">Diambil (Sudah Bayar)</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-cancel" onclick="closeModal('modalStatus')">Batal</button>
                    <button type="submit" class="primary-btn">Simpan Status</button>
                </div>
            </form>
        </div>
    </div>
    <script type="module" src="js/dashboard.js"></script>
</body>
</html>